ResultsMicrobiome <- read_excel("micro.xlsx")
View(ResultsMicrobiome)
```
update.packages("tidyverse")
```{r}
# functions for analysis
chiFilter <- function(c1, c2){
# c1 = first column of interest
# c2 = second column of interest
df1 <- data.frame(c1, c2) %>% na.omit()
tab <- table(df1$c1, df1$c2)
print(tab)
chi <- chisq.test(tab)
return(chi)
}
```
install.packages("rlang")
install.packages("rlang")
install.packages("rlang")
install.packages("rlang")
install.packages("rlang")
#set working directory and bring in the Excel Sheet
#setwd("~/University/University 2020-2021/thesis/MicrobiomeThesis")
library(readxl)
library(tidyverse)
update.packages("rlang")
#set working directory and bring in the Excel Sheet
#setwd("~/University/University 2020-2021/thesis/MicrobiomeThesis")
library(readxl)
library(tidyverse)
#set working directory and bring in the Excel Sheet
#setwd("~/University/University 2020-2021/thesis/MicrobiomeThesis")
library(readxl)
library(tidyverse)
---
title: "R Notebook"
output: html_notebook
---
devtools::install_github("haleyjeppson/ggmosaic")
---
title: "R Notebook"
output: html_notebook
---
install.packages("devtools")
devtools::install_github("haleyjeppson/ggmosaic")
#set working directory and bring in the Excel Sheet
#setwd("~/University/University 2020-2021/thesis/MicrobiomeThesis")
library(readxl)
library()
library(tidyverse)
library(ggmosaic)
---
title: "R Notebook"
output: html_notebook
---
install.packages("devtools")
devtools::install_github("haleyjeppson/ggmosaic")
install.packages("ggmosaic")
#set working directory and bring in the Excel Sheet
#setwd("~/University/University 2020-2021/thesis/MicrobiomeThesis")
library(readxl)
library()
library(tidyverse)
update.packages("vctrs")
update.packages("vctrs")
#set working directory and bring in the Excel Sheet
#setwd("~/University/University 2020-2021/thesis/MicrobiomeThesis")
library(readxl)
library()
library(tidyverse)
#set working directory and bring in the Excel Sheet
#setwd("~/University/University 2020-2021/thesis/MicrobiomeThesis")
library(readxl)
library(tidyverse)
remove.packages("ggmosaic")
install.packages("ggmosaic")
#set working directory and bring in the Excel Sheet
#setwd("~/University/University 2020-2021/thesis/MicrobiomeThesis")
library(readxl)
library(tidyverse)
remove.packages("tidyverse")
install.packages("tidyverse")
#set working directory and bring in the Excel Sheet
#setwd("~/University/University 2020-2021/thesis/MicrobiomeThesis")
library(readxl)
library(tidyverse)
#set working directory and bring in the Excel Sheet
#setwd("~/University/University 2020-2021/thesis/MicrobiomeThesis")
library(readxl)
library(tidyverse)
remove.packages("vctrs")
#set working directory and bring in the Excel Sheet
#setwd("~/University/University 2020-2021/thesis/MicrobiomeThesis")
library(readxl)
library(tidyverse)
remove.packages("tidyverse")
install.packages("tidyverse")
#set working directory and bring in the Excel Sheet
#setwd("~/University/University 2020-2021/thesis/MicrobiomeThesis")
library(readxl)
library(tidyverse)
update.packages("vctrs")
#set working directory and bring in the Excel Sheet
#setwd("~/University/University 2020-2021/thesis/MicrobiomeThesis")
library(readxl)
library(tidyverse)
install.packages("vctrs", version='0.3.6')
install.packages("vctrs", version = "0.3.6")
#set working directory and bring in the Excel Sheet
#setwd("~/University/University 2020-2021/thesis/MicrobiomeThesis")
library(readxl)
library(tidyverse)
library(ggplot2)
library(ggmosaic)
#~/University/University 2020-2021/thesis/MicrobiomeThesis/
# read in spreadsheets
ResultsMicrobiome <- read_excel("micro.xlsx")
View(ResultsMicrobiome)
# functions for analysis
chiFilter <- function(c1, c2){
# c1 = first column of interest
# c2 = second column of interest
df1 <- data.frame(c1, c2) %>% na.omit()
tab <- table(df1$c1, df1$c2)
print(tab)
chi <- chisq.test(tab)
return(chi)
}
# apply (quicker step)
columns <- list(ResultsMicrobiome$NestedCore, ResultsMicrobiome$CommonCore, ResultsMicrobiome$TemporalCore)
# table for field of study and core definition used
lapply(columns, chiFilter, c1 = ResultsMicrobiome$FieldOfStudy)
# field of study x core microbiome
ggplot(data = ResultsMicrobiome) + geom_mosaic(aes(x = product(V1), fill=FieldOfStudy)) +
labs(title='f(do_you_recline | rude_to_recline) f(rude_to_recline)')
# table for positive/negative interaction and core definition used
test <-
lapply(columns, chiFilter, c1 = ResultsMicrobiome$PositiveOrNegativeInteraction)
# table for positive/negative interaction and core definition used
test <- lapply(columns, chiFilter, c1 = ResultsMicrobiome$PositiveOrNegativeInteraction)
View(test)
test[[1]][["p.value"]]
lapply(test, function(x) x[[i]]["p.value"])
lapply(test, function(x) x["p.value"])
lapply(test, function(x) x$p.value)
tst <- lapply(test, function(x) x$p.value)
p.adjust(tst, method = "bonferroni", n = length(tst))
View(test)
View(tst)
# table for field of study and core definition used
FOS <- lapply(columns, chiFilter, c1 = ResultsMicrobiome$FieldOfStudy)
FOSp <- lapply(FOS, function(x) x$p.value)
# table for field of study and core definition used
FOS <- lapply(columns, chiFilter, c1 = ResultsMicrobiome$FieldOfStudy)
#set working directory and bring in the Excel Sheet
#setwd("~/University/University 2020-2021/thesis/MicrobiomeThesis")
library(readxl)
library(tidyverse)
library(ggmosaic)
#~/University/University 2020-2021/thesis/MicrobiomeThesis/
# read in spreadsheets
ResultsMicrobiome <- read_excel("micro.xlsx")
View(ResultsMicrobiome)
# functions for analysis
chiFilter <- function(c1, c2){
# c1 = first column of interest
# c2 = second column of interest
df1 <- data.frame(c1, c2) %>% na.omit()
tab <- table(df1$c1, df1$c2)
print(tab)
chi <- chisq.test(tab)
return(chi)
}
# apply (quicker step)
columns <- list(ResultsMicrobiome$NestedCore, ResultsMicrobiome$CommonCore, ResultsMicrobiome$TemporalCore)
# table for field of study and core definition used
FOS <- lapply(columns, chiFilter, c1 = ResultsMicrobiome$FieldOfStudy)
FOSp <- lapply(FOS, function(x) x$p.value)
# table for study system and core definition used
SS <- lapply(columns, chiFilter, c1 = ResultsMicrobiome$HostType)
SSp <- lapply(SS, function(x) x$p.value)
# table for positive/negative interaction and core definition used
PNI <- lapply(columns, chiFilter, c1 = ResultsMicrobiome$PositiveOrNegativeInteraction)
PNIp <- lapply(PNI, function(x) x$p.value)
# table for effect on host fitness and core definition used
EHF <- lapply(columns, chiFilter, c1 = ResultsMicrobiome$EffectOnHostFitness)
EHFp <- lapply(EHF, function(x) x$p.value)
pval <- c(SSp,PNIp,FOSp,EHFp)
View(pval)
p.adjust(pval, method = "bonferroni", n = length(pval))
View(PNIp)
View(PNI)
View(PNIp)
# field of study x core microbiome
ggplot(data = ResultsMicrobiome) + geom_mosaic(aes(x = FieldOfStudy, fill = interaction(CommonCore, TemporalCore, NestedCore))) +
labs(title='f(do_you_recline | rude_to_recline) f(rude_to_recline)')
# field of study x core microbiome
ggplot(data = ResultsMicrobiome) + geom_mosaic(aes(fill = FieldOfStudy, x = interaction(CommonCore, TemporalCore, NestedCore))) +
labs(title='f(do_you_recline | rude_to_recline) f(rude_to_recline)')
# field of study x core microbiome
ggplot(ResultsMicrobiome) + geom_mosaic(aes(fill = FieldOfStudy, x = interaction(CommonCore, TemporalCore, NestedCore))) +
labs(title='f(do_you_recline | rude_to_recline) f(rude_to_recline)')
# field of study x core microbiome
ggplot(ResultsMicrobiome) + geom_mosaic(aes(x = product(FieldOfStudy), fill = interaction(CommonCore, TemporalCore, NestedCore))) +
labs(title='f(do_you_recline | rude_to_recline) f(rude_to_recline)')
# field of study x core microbiome
ggplot(ResultsMicrobiome) + geom_mosaic(aes(x = product(FieldOfStudy), fill = interaction(CommonCore))) +
labs(title='f(do_you_recline | rude_to_recline) f(rude_to_recline)')
# field of study x core microbiome
ggplot(ResultsMicrobiome) + geom_mosaic(aes(x = product(FieldOfStudy), fill = CommonCore)) +
labs(title='f(do_you_recline | rude_to_recline) f(rude_to_recline)')
# field of study x core microbiome
ggplot(ResultsMicrobiome) + geom_mosaic(aes(x = product(FieldOfStudy), fill = interaction(CommonCore, TemporalCore)) +
# field of study x core microbiome
ggplot(ResultsMicrobiome) + geom_mosaic(aes(x = product(FieldOfStudy), fill = interaction(CommonCore, TemporalCore)) +
labs(title='f(do_you_recline | rude_to_recline) f(rude_to_recline)')
# field of study x core microbiome
ggplot(ResultsMicrobiome) + geom_mosaic(aes(x = product(FieldOfStudy), fill = interaction(CommonCore, TemporalCore)) +
labs(title='f(do_you_recline | rude_to_recline) f(rude_to_recline)')
# field of study x core microbiome
ggplot(ResultsMicrobiome) + geom_mosaic(aes(x = product(FieldOfStudy), fill = interaction(CommonCore, NestedCore)) +
# field of study x core microbiome
ggplot(ResultsMicrobiome) + geom_mosaic(aes(x = product(FieldOfStudy), fill = interaction(CommonCore, NestedCore)) +
labs(title='f(do_you_recline | rude_to_recline) f(rude_to_recline)')
# field of study x core microbiome
ggplot(ResultsMicrobiome) + geom_mosaic(aes(x = product(FieldOfStudy), fill = interaction(CommonCore, NestedCore))
# field of study x core microbiome
ggplot(ResultsMicrobiome) + geom_mosaic(aes(x = product(FieldOfStudy), fill = interaction(CommonCore, NestedCore)))
coresbind <- paste(ResultsMicrobiome$NestedCore, ResultsMicrobiome$CommonCore, ResultsMicrobiome$TemporalCore)
View(coresbind)
ResultsMicrobiome$CombinedCore <- ResultsMicrobiome %>% interaction(NestedCore, CommonCore, TemporalCore)
ResultsMicrobiome$CombinedCore <- interaction(ResultsMicrobiome$NestedCore, ResultsMicrobiome$CommonCore, ResultsMicrobiome$TemporalCore)
View(ResultsMicrobiome$CombinedCore)
# field of study x core microbiome
ggplot(ResultsMicrobiome) + geom_mosaic(aes(x = product(FieldOfStudy), fill = (interaction(CombinedCore)))
# field of study x core microbiome
ggplot(ResultsMicrobiome) + geom_mosaic(aes(x = product(FieldOfStudy), fill = CombinedCore))
install.packages("vctrs", version='0.3.6')
#set working directory and bring in the Excel Sheet
#setwd("~/University/University 2020-2021/thesis/MicrobiomeThesis")
library(readxl)
library(tidyverse)
library(ggmosaic)
#~/University/University 2020-2021/thesis/MicrobiomeThesis/
# read in spreadsheets
ResultsMicrobiome <- read_excel("micro.xlsx")
View(ResultsMicrobiome)
# functions for analysis
chiFilter <- function(c1, c2){
# c1 = first column of interest
# c2 = second column of interest
df1 <- data.frame(c1, c2) %>% na.omit()
tab <- table(df1$c1, df1$c2)
print(tab)
chi <- chisq.test(tab)
return(chi)
}
# apply (quicker step)
columns <- list(ResultsMicrobiome$NestedCore, ResultsMicrobiome$CommonCore, ResultsMicrobiome$TemporalCore)
# table for field of study and core definition used
FOS <- lapply(columns, chiFilter, c1 = ResultsMicrobiome$FieldOfStudy)
FOSp <- lapply(FOS, function(x) x$p.value)
pval <- c(SSp,PNIp,FOSp,EHFp)
p.adjust(pval, method = "holm", length(pval))
# field of study x core microbiome
ggplot(ResultsMicrobiome) + geom_mosaic(aes(x = product(FieldOfStudy), fill = CombinedCore)) + (labels = c("Ecological Only", "Functional Only", "Host-adapted Only", "Ecological and Common", "Functional and Common", "Host-adapted and Common", "Ecological and Temporal", "Functional and Temporal", "Host-adapted and Temporal", "Ecological, Common, and Temporal", "Functional, Common, and Temporal", "Host-adapted, Common, and Temporal"))
corePlot <- ggplot(micro, aes(x = NestedCore, # possible to do intersection here instead
fill = interaction(CommonCore, TemporalCore))) +
geom_bar() +
# changing the x axis tick labels
# discrete b/c the levels are unique (not on a continuous scale)
scale_x_discrete(labels = c("Ecological", "Functional", "Host-adapted", "None")) +
# changing the interaction legend
# also adds viridis color scheme (d for discrete as above)
scale_fill_viridis_d(labels = c("Neither", "Common Only", "Temporal Only", "Both")) +
# adjust axis and legend names
labs(x = "Nested Core Definition", y = "Number of Articles",
fill = "Common or Temporal")
# field of study x core microbiome
ggplot(ResultsMicrobiome) + geom_mosaic(aes(x = product(FieldOfStudy), fill = CombinedCore)) + scale_x_discrete(labels = c("Ecological Only", "Functional Only", "Host-adapted Only", "Ecological and Common", "Functional and Common", "Host-adapted and Common", "Ecological and Temporal", "Functional and Temporal", "Host-adapted and Temporal", "Ecological, Common, and Temporal", "Functional, Common, and Temporal", "Host-adapted, Common, and Temporal"))
#set working directory and bring in the Excel Sheet
#setwd("~/University/University 2020-2021/thesis/MicrobiomeThesis")
library(readxl)
library(tidyverse)
library(ggmosaic)
#~/University/University 2020-2021/thesis/MicrobiomeThesis/
# read in spreadsheets
ResultsMicrobiome <- read_excel("micro.xlsx")
View(ResultsMicrobiome)
# functions for analysis
chiFilter <- function(c1, c2){
# c1 = first column of interest
# c2 = second column of interest
df1 <- data.frame(c1, c2) %>% na.omit()
tab <- table(df1$c1, df1$c2)
print(tab)
chi <- chisq.test(tab)
return(chi)
}
# apply (quicker step)
columns <- list(ResultsMicrobiome$NestedCore, ResultsMicrobiome$CommonCore, ResultsMicrobiome$TemporalCore)
# field of study x core microbiome
ggplot(ResultsMicrobiome) + geom_mosaic(aes(x = product(FieldOfStudy), fill = CombinedCore)) + scale_x_discrete(labels = c("Ecological Only", "Functional Only", "Host-adapted Only", "Ecological and Common", "Functional and Common", "Host-adapted and Common", "Ecological and Temporal", "Functional and Temporal", "Host-adapted and Temporal", "Ecological, Common, and Temporal", "Functional, Common, and Temporal", "Host-adapted, Common, and Temporal"))
ResultsMicrobiome$CombinedCore <- interaction(ResultsMicrobiome$NestedCore, ResultsMicrobiome$CommonCore, ResultsMicrobiome$TemporalCore)
View(ResultsMicrobiome$CombinedCore)
# field of study x core microbiome
ggplot(ResultsMicrobiome) + geom_mosaic(aes(x = product(FieldOfStudy), fill = CombinedCore)) + scale_x_discrete(labels = c("Ecological Only", "Functional Only", "Host-adapted Only", "Ecological and Common", "Functional and Common", "Host-adapted and Common", "Ecological and Temporal", "Functional and Temporal", "Host-adapted and Temporal", "Ecological, Common, and Temporal", "Functional, Common, and Temporal", "Host-adapted, Common, and Temporal"))
# field of study x core microbiome
ggplot(ResultsMicrobiome) + geom_mosaic(aes(x = product(FieldOfStudy), fill = CombinedCore)) + (labels = c("Ecological Only", "Functional Only", "Host-adapted Only", "Ecological and Common", "Functional and Common", "Host-adapted and Common", "Ecological and Temporal", "Functional and Temporal", "Host-adapted and Temporal", "Ecological, Common, and Temporal", "Functional, Common, and Temporal", "Host-adapted, Common, and Temporal"))
# field of study x core microbiome
ggplot(ResultsMicrobiome) + geom_mosaic(aes(x = product(FieldOfStudy), fill = CombinedCore)) + scale_x_discrete(labels = c("Ecological Only", "Functional Only", "Host-adapted Only", "Ecological and Common", "Functional and Common", "Host-adapted and Common", "Ecological and Temporal", "Functional and Temporal", "Host-adapted and Temporal", "Ecological, Common, and Temporal", "Functional, Common, and Temporal", "Host-adapted, Common, and Temporal"))
# field of study x core microbiome
ggplot(ResultsMicrobiome) + geom_mosaic(aes(x = product(FieldOfStudy), fill = CombinedCore)) + scale_x_continuous(labels = c("Ecological Only", "Functional Only", "Host-adapted Only", "Ecological and Common", "Functional and Common", "Host-adapted and Common", "Ecological and Temporal", "Functional and Temporal", "Host-adapted and Temporal", "Ecological, Common, and Temporal", "Functional, Common, and Temporal", "Host-adapted, Common, and Temporal"))
# field of study x core microbiome
ggplot(ResultsMicrobiome) + geom_mosaic(aes(x = product(FieldOfStudy), fill = CombinedCore)) + scale_x_continuous(labels = c("Ecological Only", "Functional Only", "Host-adapted Only", "Ecological and Common", "Functional and Common", "Host-adapted and Common", "Ecological and Temporal", "Functional and Temporal", "Host-adapted and Temporal", "Ecological, Common, and Temporal", "Functional, Common, and Temporal", "Host-adapted, Common, and Temporal"))
# field of study x core microbiome
ggplot(ResultsMicrobiome) + geom_mosaic(aes(x = product(FieldOfStudy), fill = CombinedCore)) + scale_x_continuous(labels = c("Ecological Only", "Functional Only", "Host-adapted Only", "Ecological and Common", "Functional and Common", "Host-adapted and Common", "Ecological and Temporal", "Functional and Temporal", "Host-adapted and Temporal", "Ecological, Common, and Temporal", "Functional, Common, and Temporal", "Host-adapted, Common, and Temporal"))
# field of study x core microbiome
ggplot(ResultsMicrobiome) + geom_mosaic(aes(x = product(FieldOfStudy), fill = CombinedCore)) + labs(y = "Ecological Only", "Functional Only", "Host-adapted Only", "Ecological and Common", "Functional and Common", "Host-adapted and Common", "Ecological and Temporal", "Functional and Temporal", "Host-adapted and Temporal", "Ecological, Common, and Temporal", "Functional, Common, and Temporal", "Host-adapted, Common, and Temporal"))
# field of study x core microbiome
ggplot(ResultsMicrobiome) + geom_mosaic(aes(x = product(FieldOfStudy), fill = CombinedCore)) +
labs(y = "Ecological Only", "Functional Only", "Host-adapted Only", "Ecological and Common", "Functional and Common", "Host-adapted and Common", "Ecological and Temporal", "Functional and Temporal", "Host-adapted and Temporal", "Ecological, Common, and Temporal", "Functional, Common, and Temporal", "Host-adapted, Common, and Temporal"))
# field of study x core microbiome
ggplot(ResultsMicrobiome) + geom_mosaic(aes(x = product(FieldOfStudy), fill = CombinedCore)) +
xlabs(y = "Ecological Only", "Functional Only", "Host-adapted Only", "Ecological and Common", "Functional and Common", "Host-adapted and Common", "Ecological and Temporal", "Functional and Temporal", "Host-adapted and Temporal", "Ecological, Common, and Temporal", "Functional, Common, and Temporal", "Host-adapted, Common, and Temporal"))
# field of study x core microbiome
ggplot(ResultsMicrobiome) + geom_mosaic(aes(x = product(FieldOfStudy), fill = CombinedCore)) +
xlab(y = "Ecological Only", "Functional Only", "Host-adapted Only", "Ecological and Common", "Functional and Common", "Host-adapted and Common", "Ecological and Temporal", "Functional and Temporal", "Host-adapted and Temporal", "Ecological, Common, and Temporal", "Functional, Common, and Temporal", "Host-adapted, Common, and Temporal"))
# field of study x core microbiome
ggplot(ResultsMicrobiome) + geom_mosaic(aes(x = product(FieldOfStudy), fill = CombinedCore)) +
scale_x_discrete(labels=c ("Ecological Only", "Functional Only", "Host-adapted Only", "Ecological and Common", "Functional and Common", "Host-adapted and Common", "Ecological and Temporal", "Functional and Temporal", "Host-adapted and Temporal", "Ecological, Common, and Temporal", "Functional, Common, and Temporal", "Host-adapted, Common, and Temporal"))
# field of study x core microbiome
ggplot(ResultsMicrobiome) + geom_mosaic(aes(x = product(FieldOfStudy), fill = CombinedCore)) +
scale_x_discrete(labels=c("Ecological Only", "Functional Only", "Host-adapted Only", "Ecological and Common", "Functional and Common", "Host-adapted and Common", "Ecological and Temporal", "Functional and Temporal", "Host-adapted and Temporal", "Ecological, Common, and Temporal", "Functional, Common, and Temporal", "Host-adapted, Common, and Temporal")))
# field of study x core microbiome
ggplot(ResultsMicrobiome) + geom_mosaic(aes(x = product(FieldOfStudy), fill = CombinedCore))
# field of study x core microbiome
ggplot(ResultsMicrobiome) + geom_mosaic(aes(x = product(FieldOfStudy), fill = CombinedCore)) +
scale_x_discrete(breaks=c("ecological.no.no", "functional.no.no", "host-adapted.no.no", "ecological.yes.no", "functional.yes.no", "host-adapted.yes.no", "ecological.no.yes", "functional.no.yes", "host-adapted.no.yes", "ecological.yes.yes", "functional.yes.yes", "host-adapted.yes.yes"))
# field of study x core microbiome
ggplot(ResultsMicrobiome) + geom_mosaic(aes(x = product(FieldOfStudy), fill = CombinedCore)) +
scale_x_continuous(breaks=c("ecological.no.no", "functional.no.no", "host-adapted.no.no", "ecological.yes.no", "functional.yes.no", "host-adapted.yes.no", "ecological.no.yes", "functional.no.yes", "host-adapted.no.yes", "ecological.yes.yes", "functional.yes.yes", "host-adapted.yes.yes"))
# field of study x core microbiome
ggplot(ResultsMicrobiome) + geom_mosaic(aes(x = product(FieldOfStudy), fill = CombinedCore)) +
scale_y_continuous(breaks=c("ecological.no.no", "functional.no.no", "host-adapted.no.no", "ecological.yes.no", "functional.yes.no", "host-adapted.yes.no", "ecological.no.yes", "functional.no.yes", "host-adapted.no.yes", "ecological.yes.yes", "functional.yes.yes", "host-adapted.yes.yes"))
# field of study x core microbiome
ggplot(ResultsMicrobiome) +
geom_mosaic(aes(x = product(FieldOfStudy), fill = CombinedCore)) +
scale_fill_viridis_d
library(readxl)
library(tidyverse)
library(ggplot2)
setwd("~/University/University 2020-2021/thesis/MicrobiomeThesis")
theme_set(theme_minimal())
micro <- read_excel("micro.xlsx")
View(micro)
fieldPlot<- ggplot(data=micro, aes(x=FieldOfStudy)) +
geom_bar(fill="steelblue") +
labs(x = "Field of Study", y = "Number of Articles")
fieldPlot
corePlot <- ggplot(micro, aes(x = NestedCore, # possible to do intersection here instead
fill = interaction(CommonCore, TemporalCore))) +
geom_bar() +
# changing the x axis tick labels
# discrete b/c the levels are unique (not on a continuous scale)
scale_x_discrete(labels = c("Ecological", "Functional", "Host-adapted", "None")) +
# changing the interaction legend
# also adds viridis color scheme (d for discrete as above)
scale_fill_viridis_d(labels = c("Neither", "Common Only", "Temporal Only", "Both")) +
# adjust axis and legend names
labs(x = "Nested Core Definition", y = "Number of Articles",
fill = "Common or Temporal")
corePlot
# creating the ggplot for field of study
fieldPlot<- ggplot(data=micro, aes(x=FieldOfStudy)) +
geom_bar(fill="steelblue") +
labs(x = "Field of Study", y = "Number of Articles")
fieldPlot
corePlot <- ggplot(micro, aes(x = NestedCore, # possible to do intersection here instead
fill = interaction(CommonCore, TemporalCore))) +
geom_bar() +
# changing the x axis tick labels
# discrete b/c the levels are unique (not on a continuous scale)
scale_x_discrete(labels = c("Ecological", "Functional", "Host-adapted", "None")) +
# changing the interaction legend
# also adds viridis color scheme (d for discrete as above)
scale_fill_viridis_d(labels = c("Neither", "Common Only", "Temporal Only", "Both")) +
# adjust axis and legend names
labs(x = "Nested Core Definition", y = "Number of Articles",
fill = "Common or Temporal")
corePlot
# field of study x core microbiome
ggplot(ResultsMicrobiome) +
geom_mosaic(aes(x = product(FieldOfStudy), fill = CombinedCore)) +
scale_y_discrete(labels=c("Ecological Only", "Functional Only", "Host-adapted Only", "Ecological and Common", "Functional and Common", "Host-adapted and Common", "Ecological and Temporal", "Functional and Temporal", "Host-adapted and Temporal", "Ecological, Common, and Temporal", "Functional, Common, and Temporal", "Host-adapted, Common, and Temporal"))
# field of study x core microbiome
ggplot(ResultsMicrobiome) +
geom_mosaic(aes(x = product(FieldOfStudy), fill = CombinedCore)) +
scale_y_discrete(labels=c("Ecological Only", "Functional Only", "Host-adapted Only", "Ecological and Common", "Functional and Common", "Host-adapted and Common", "Ecological and Temporal", "Functional and Temporal", "Host-adapted and Temporal", "Ecological, Common, and Temporal", "Functional, Common, and Temporal", "Host-adapted, Common, and Temporal"))
# field of study x core microbiome
ggplot(ResultsMicrobiome) +
geom_mosaic(aes(x = product(FieldOfStudy), fill = CombinedCore)) +
scale_y_discrete(labels=c("Ecological Only", "Functional Only", "Host-adapted Only", "Ecological and Common", "Functional and Common", "Host-adapted and Common", "Ecological and Temporal", "Functional and Temporal", "Host-adapted and Temporal", "Ecological, Common, and Temporal", "Functional, Common, and Temporal", "Host-adapted, Common, and Temporal"))
# field of study x core microbiome
ggplot(ResultsMicrobiome) +
geom_mosaic(aes(x = product(FieldOfStudy), fill = CombinedCore)) +
scale_y_continuous(labels=c("Ecological Only", "Functional Only", "Host-adapted Only", "Ecological and Common", "Functional and Common", "Host-adapted and Common", "Ecological and Temporal", "Functional and Temporal", "Host-adapted and Temporal", "Ecological, Common, and Temporal", "Functional, Common, and Temporal", "Host-adapted, Common, and Temporal"))
# field of study x core microbiome
ggplot(ResultsMicrobiome) +
geom_mosaic(aes(x = product(FieldOfStudy), fill = CombinedCore)) +
scale_y_continuous(labels=c("Ecological Only", "Functional Only", "Host-adapted Only", "Ecological and Common", "Functional and Common", "Host-adapted and Common", "Ecological and Temporal", "Functional and Temporal", "Host-adapted and Temporal", "Ecological, Common, and Temporal", "Functional, Common, and Temporal", "Host-adapted, Common, and Temporal"))
# field of study x core microbiome
ggplot(ResultsMicrobiome) +
geom_mosaic(aes(x = product(FieldOfStudy), fill = CombinedCore)) +
scale_y_discrete(labels=c("Ecological Only", "Functional Only", "Host-adapted Only", "Ecological and Common", "Functional and Common", "Host-adapted and Common", "Ecological and Temporal", "Functional and Temporal", "Host-adapted and Temporal", "Ecological, Common, and Temporal", "Functional, Common, and Temporal", "Host-adapted, Common, and Temporal"))
# field of study x core microbiome
ggplot(ResultsMicrobiome) +
geom_mosaic(aes(x = product(FieldOfStudy), fill = CombinedCore))
# field of study x core microbiome
ggplot(ResultsMicrobiome) +
geom_mosaic(aes(x = product(FieldOfStudy), fill = CombinedCore)) +
title(ysub = "ecological only")
# field of study x core microbiome
ggplot(ResultsMicrobiome) +
geom_mosaic(aes(x = product(FieldOfStudy), fill = CombinedCore)) +
title(sub = "ecological only")
# field of study x core microbiome
ggplot(ResultsMicrobiome) +
geom_mosaic(aes(x = product(FieldOfStudy), fill = CombinedCore)) +
axis(y, labels=c("Ecological Only", "Functional Only", "Host-adapted Only", "Ecological and Common", "Functional and Common", "Host-adapted and Common", "Ecological and Temporal", "Functional and Temporal", "Host-adapted and Temporal", "Ecological, Common, and Temporal", "Functional, Common, and Temporal", "Host-adapted, Common, and Temporal")))
# field of study x core microbiome
ggplot(ResultsMicrobiome) +
geom_mosaic(aes(x = product(FieldOfStudy), fill = CombinedCore)) +
axis(y, labels=("Ecological Only", "Functional Only", "Host-adapted Only", "Ecological and Common", "Functional and Common", "Host-adapted and Common", "Ecological and Temporal", "Functional and Temporal", "Host-adapted and Temporal", "Ecological, Common, and Temporal", "Functional, Common, and Temporal", "Host-adapted, Common, and Temporal")))
# field of study x core microbiome
ggplot(ResultsMicrobiome) +
geom_mosaic(aes(x = product(FieldOfStudy), fill = CombinedCore)) +
axis(y, labels= "Ecological Only", "Functional Only", "Host-adapted Only", "Ecological and Common", "Functional and Common", "Host-adapted and Common", "Ecological and Temporal", "Functional and Temporal", "Host-adapted and Temporal", "Ecological, Common, and Temporal", "Functional, Common, and Temporal", "Host-adapted, Common, and Temporal")
# field of study x core microbiome
ggplot(ResultsMicrobiome) +
geom_mosaic(aes(x = product(FieldOfStudy), fill = CombinedCore)) +
axis(labels= "Ecological Only", "Functional Only", "Host-adapted Only", "Ecological and Common", "Functional and Common", "Host-adapted and Common", "Ecological and Temporal", "Functional and Temporal", "Host-adapted and Temporal", "Ecological, Common, and Temporal", "Functional, Common, and Temporal", "Host-adapted, Common, and Temporal")
# field of study x core microbiome
ggplot(ResultsMicrobiome) +
geom_mosaic(aes(x = product(FieldOfStudy), fill = CombinedCore)) +
axis.text.y(labels= "Ecological Only", "Functional Only", "Host-adapted Only", "Ecological and Common", "Functional and Common", "Host-adapted and Common", "Ecological and Temporal", "Functional and Temporal", "Host-adapted and Temporal", "Ecological, Common, and Temporal", "Functional, Common, and Temporal", "Host-adapted, Common, and Temporal")
# field of study x core microbiome
ggplot(ResultsMicrobiome) +
geom_mosaic(aes(x = product(FieldOfStudy), fill = CombinedCore)) +
scale_y_discrete(breaks=c("ecological.no.no", "functional.no.no", "host-adapted.no.no", "ecological.yes.no", "functional.yes.no", "host-adapted.yes.no", "ecological.no.yes", "functional.no.yes", "host-adapted.no.yes", "ecological.yes.yes", "functional.yes.yes", "host-adapted.yes.yes"), labels=c("Ecological Only", "Functional Only", "Host-adapted Only", "Ecological and Common", "Functional and Common", "Host-adapted and Common", "Ecological and Temporal", "Functional and Temporal", "Host-adapted and Temporal", "Ecological, Common, and Temporal", "Functional, Common, and Temporal", "Host-adapted, Common, and Temporal")
# field of study x core microbiome
ggplot(ResultsMicrobiome) +
geom_mosaic(aes(x = product(FieldOfStudy), fill = CombinedCore)) +
(scale_y_discrete(breaks=c("ecological.no.no", "functional.no.no", "host-adapted.no.no", "ecological.yes.no", "functional.yes.no", "host-adapted.yes.no", "ecological.no.yes", "functional.no.yes", "host-adapted.no.yes", "ecological.yes.yes", "functional.yes.yes", "host-adapted.yes.yes"), labels=c("Ecological Only", "Functional Only", "Host-adapted Only", "Ecological and Common", "Functional and Common", "Host-adapted and Common", "Ecological and Temporal", "Functional and Temporal", "Host-adapted and Temporal", "Ecological, Common, and Temporal", "Functional, Common, and Temporal", "Host-adapted, Common, and Temporal"))
# field of study x core microbiome
ggplot(ResultsMicrobiome) +
geom_mosaic(aes(x = product(FieldOfStudy), fill = CombinedCore)) +
scale_y_discrete(breaks=c("ecological.no.no", "functional.no.no", "host-adapted.no.no", "ecological.yes.no", "functional.yes.no", "host-adapted.yes.no", "ecological.no.yes", "functional.no.yes", "host-adapted.no.yes", "ecological.yes.yes", "functional.yes.yes", "host-adapted.yes.yes"), labels=c("Ecological Only", "Functional Only", "Host-adapted Only", "Ecological and Common", "Functional and Common", "Host-adapted and Common", "Ecological and Temporal", "Functional and Temporal", "Host-adapted and Temporal", "Ecological, Common, and Temporal", "Functional, Common, and Temporal", "Host-adapted, Common, and Temporal"))
# field of study x core microbiome
ggplot(ResultsMicrobiome) +
geom_mosaic(aes(x = product(FieldOfStudy), fill = CombinedCore)) +
scale_fill_discrete(breaks=c("ecological.no.no", "functional.no.no", "host-adapted.no.no", "ecological.yes.no", "functional.yes.no", "host-adapted.yes.no", "ecological.no.yes", "functional.no.yes", "host-adapted.no.yes", "ecological.yes.yes", "functional.yes.yes", "host-adapted.yes.yes"), labels=c("Ecological Only", "Functional Only", "Host-adapted Only", "Ecological and Common", "Functional and Common", "Host-adapted and Common", "Ecological and Temporal", "Functional and Temporal", "Host-adapted and Temporal", "Ecological, Common, and Temporal", "Functional, Common, and Temporal", "Host-adapted, Common, and Temporal"))
# field of study x core microbiome
ggplot(ResultsMicrobiome) +
geom_mosaic(aes(x = product(FieldOfStudy), fill = CombinedCore)) +
scale_fill_discrete(breaks=c("ecological.no.no", "functional.no.no", "host-adapted.no.no", "ecological.yes.no", "functional.yes.no", "host-adapted.yes.no", "ecological.no.yes", "functional.no.yes", "host-adapted.no.yes", "ecological.yes.yes", "functional.yes.yes", "host-adapted.yes.yes"), labels=c("Ecological Only", "Functional Only", "Host-adapted Only", "Ecological and Common", "Functional and Common", "Host-adapted and Common", "Ecological and Temporal", "Functional and Temporal", "Host-adapted and Temporal", "Ecological, Common, and Temporal", "Functional, Common, and Temporal", "Host-adapted, Common, and Temporal")) +
scale_fill_viridis_d(labels = c("Ecological Only", "Functional Only", "Host-adapted Only", "Ecological and Common", "Functional and Common", "Host-adapted and Common", "Ecological and Temporal", "Functional and Temporal", "Host-adapted and Temporal", "Ecological, Common, and Temporal", "Functional, Common, and Temporal", "Host-adapted, Common, and Temporal"))
# field of study x core microbiome
FOSGraph <- ggplot(ResultsMicrobiome) +
geom_mosaic(aes(x = product(FieldOfStudy), fill = CombinedCore)) +
scale_fill_discrete(breaks=c("ecological.no.no", "functional.no.no", "host-adapted.no.no", "ecological.yes.no", "functional.yes.no", "host-adapted.yes.no", "ecological.no.yes", "functional.no.yes", "host-adapted.no.yes", "ecological.yes.yes", "functional.yes.yes", "host-adapted.yes.yes"), labels=c("Ecological Only", "Functional Only", "Host-adapted Only", "Ecological and Common", "Functional and Common", "Host-adapted and Common", "Ecological and Temporal", "Functional and Temporal", "Host-adapted and Temporal", "Ecological, Common, and Temporal", "Functional, Common, and Temporal", "Host-adapted, Common, and Temporal")) +
scale_fill_viridis_d(labels = c("Ecological Only", "Functional Only", "Host-adapted Only", "Ecological and Common", "Functional and Common", "Host-adapted and Common", "Ecological and Temporal", "Functional and Temporal", "Host-adapted and Temporal", "Ecological, Common, and Temporal", "Functional, Common, and Temporal", "Host-adapted, Common, and Temporal"))
View()
View(FOSGraph)
View(FOSGraph)
FOSGraph
# field of study x core microbiome
FOSGraph <- ggplot(ResultsMicrobiome) +
geom_mosaic(aes(x = product(FieldOfStudy), fill = CombinedCore)) +
scale_fill_discrete(breaks=c("ecological.no.no", "functional.no.no", "host-adapted.no.no", "ecological.yes.no", "functional.yes.no", "host-adapted.yes.no", "ecological.no.yes", "functional.no.yes", "host-adapted.no.yes", "ecological.yes.yes", "functional.yes.yes", "host-adapted.yes.yes"), labels=c("Ecological Only", "Functional Only", "Host-adapted Only", "Ecological and Common", "Functional and Common", "Host-adapted and Common", "Ecological and Temporal", "Functional and Temporal", "Host-adapted and Temporal", "Ecological, Common, and Temporal", "Functional, Common, and Temporal", "Host-adapted, Common, and Temporal")) +
scale_fill_viridis_d(labels = c("Ecological Only", "Functional Only", "Host-adapted Only", "Ecological and Common", "Functional and Common", "Host-adapted and Common", "Ecological and Temporal", "Functional and Temporal", "Host-adapted and Temporal", "Ecological, Common, and Temporal", "Functional, Common, and Temporal", "Host-adapted, Common, and Temporal"))
# field of study x core microbiome
FOSGraph <- ggplot(ResultsMicrobiome) +
geom_mosaic(aes(x = product(FieldOfStudy), fill = CombinedCore)) +
scale_fill_discrete(breaks=c("ecological.no.no", "functional.no.no", "host-adapted.no.no", "ecological.yes.no", "functional.yes.no", "host-adapted.yes.no", "ecological.no.yes", "functional.no.yes", "host-adapted.no.yes", "ecological.yes.yes", "functional.yes.yes", "host-adapted.yes.yes"), labels=c("Ecological Only", "Functional Only", "Host-adapted Only", "Ecological and Common", "Functional and Common", "Host-adapted and Common", "Ecological and Temporal", "Functional and Temporal", "Host-adapted and Temporal", "Ecological, Common, and Temporal", "Functional, Common, and Temporal", "Host-adapted, Common, and Temporal")) +
scale_fill_viridis_d(labels = c("Ecological Only", "Functional Only", "Host-adapted Only", "Ecological and Common", "Functional and Common", "Host-adapted and Common", "Ecological and Temporal", "Functional and Temporal", "Host-adapted and Temporal", "Ecological, Common, and Temporal", "Functional, Common, and Temporal", "Host-adapted, Common, and Temporal"))
# field of study x core microbiome
FOSGraph <- ggplot(ResultsMicrobiome) +
geom_mosaic(aes(x = product(FieldOfStudy), fill = CombinedCore)) +
scale_fill_discrete(breaks=c("ecological.no.no", "functional.no.no", "host-adapted.no.no", "ecological.yes.no", "functional.yes.no", "host-adapted.yes.no", "ecological.no.yes", "functional.no.yes", "host-adapted.no.yes", "ecological.yes.yes", "functional.yes.yes", "host-adapted.yes.yes"), labels=c("Ecological Only", "Functional Only", "Host-adapted Only", "Ecological and Common", "Functional and Common", "Host-adapted and Common", "Ecological and Temporal", "Functional and Temporal", "Host-adapted and Temporal", "Ecological, Common, and Temporal", "Functional, Common, and Temporal", "Host-adapted, Common, and Temporal")) +
scale_fill_viridis_d(labels = c("Ecological Only", "Functional Only", "Host-adapted Only", "Ecological and Common", "Functional and Common", "Host-adapted and Common", "Ecological and Temporal", "Functional and Temporal", "Host-adapted and Temporal", "Ecological, Common, and Temporal", "Functional, Common, and Temporal", "Host-adapted, Common, and Temporal"))
# field of study x core microbiome
FOSGraph <- ggplot(ResultsMicrobiome) +
geom_mosaic(aes(x = product(FieldOfStudy), fill = CombinedCore)) +
scale_fill_discrete(breaks=c("ecological.no.no", "functional.no.no", "host-adapted.no.no", "ecological.yes.no", "functional.yes.no", "host-adapted.yes.no", "ecological.no.yes", "functional.no.yes", "host-adapted.no.yes", "ecological.yes.yes", "functional.yes.yes", "host-adapted.yes.yes"), labels=c("Ecological Only", "Functional Only", "Host-adapted Only", "Ecological and Common", "Functional and Common", "Host-adapted and Common", "Ecological and Temporal", "Functional and Temporal", "Host-adapted and Temporal", "Ecological, Common, and Temporal", "Functional, Common, and Temporal", "Host-adapted, Common, and Temporal")) +
scale_fill_viridis_d(labels = c("Ecological Only", "Functional Only", "Host-adapted Only", "Ecological and Common", "Functional and Common", "Host-adapted and Common", "Ecological and Temporal", "Functional and Temporal", "Host-adapted and Temporal", "Ecological, Common, and Temporal", "Functional, Common, and Temporal", "Host-adapted, Common, and Temporal"))
# field of study x core microbiome
FOSGraph <- ggplot(ResultsMicrobiome) +
geom_mosaic(aes(x = product(FieldOfStudy), fill = CombinedCore)) +
scale_fill_discrete(breaks=c("ecological.no.no", "functional.no.no", "host-adapted.no.no", "ecological.yes.no", "functional.yes.no", "host-adapted.yes.no", "ecological.no.yes", "functional.no.yes", "host-adapted.no.yes", "ecological.yes.yes", "functional.yes.yes", "host-adapted.yes.yes"), labels=c("Ecological Only", "Functional Only", "Host-adapted Only", "Ecological and Common", "Functional and Common", "Host-adapted and Common", "Ecological and Temporal", "Functional and Temporal", "Host-adapted and Temporal", "Ecological, Common, and Temporal", "Functional, Common, and Temporal", "Host-adapted, Common, and Temporal")) +
scale_fill_viridis_d(labels = c("Ecological Only", "Functional Only", "Host-adapted Only", "Ecological and Common", "Functional and Common", "Host-adapted and Common", "Ecological and Temporal", "Functional and Temporal", "Host-adapted and Temporal", "Ecological, Common, and Temporal", "Functional, Common, and Temporal", "Host-adapted, Common, and Temporal"))
# field of study x core microbiome
ggplot(ResultsMicrobiome) +
geom_mosaic(aes(x = product(FieldOfStudy), fill = CombinedCore)) +
scale_fill_discrete(breaks=c("ecological.no.no", "functional.no.no", "host-adapted.no.no", "ecological.yes.no", "functional.yes.no", "host-adapted.yes.no", "ecological.no.yes", "functional.no.yes", "host-adapted.no.yes", "ecological.yes.yes", "functional.yes.yes", "host-adapted.yes.yes"), labels=c("Ecological Only", "Functional Only", "Host-adapted Only", "Ecological and Common", "Functional and Common", "Host-adapted and Common", "Ecological and Temporal", "Functional and Temporal", "Host-adapted and Temporal", "Ecological, Common, and Temporal", "Functional, Common, and Temporal", "Host-adapted, Common, and Temporal")) +
scale_fill_viridis_d(labels = c("Ecological Only", "Functional Only", "Host-adapted Only", "Ecological and Common", "Functional and Common", "Host-adapted and Common", "Ecological and Temporal", "Functional and Temporal", "Host-adapted and Temporal", "Ecological, Common, and Temporal", "Functional, Common, and Temporal", "Host-adapted, Common, and Temporal"))
# field of study x core microbiome
ggplot(ResultsMicrobiome) +
geom_mosaic(aes(x = product(FieldOfStudy), fill = CombinedCore)) +
scale_fill_discrete(breaks=c("ecological.no.no", "functional.no.no", "host-adapted.no.no", "ecological.yes.no", "functional.yes.no", "host-adapted.yes.no", "ecological.no.yes", "functional.no.yes", "host-adapted.no.yes", "ecological.yes.yes", "functional.yes.yes", "host-adapted.yes.yes"), labels=c("Ecological Only", "Functional Only", "Host-adapted Only", "Ecological and Common", "Functional and Common", "Host-adapted and Common", "Ecological and Temporal", "Functional and Temporal", "Host-adapted and Temporal", "Ecological, Common, and Temporal", "Functional, Common, and Temporal", "Host-adapted, Common, and Temporal")) +
scale_fill_viridis_d(labels = c("Ecological Only", "Functional Only", "Host-adapted Only", "Ecological and Common", "Functional and Common", "Host-adapted and Common", "Ecological and Temporal", "Functional and Temporal", "Host-adapted and Temporal", "Ecological, Common, and Temporal", "Functional, Common, and Temporal", "Host-adapted, Common, and Temporal")) +
theme(axis.text.y = element_blank())
